@using Microsoft.AspNetCore.Components.Routing
@using MudBlazor;
@using ReserGO.DTO
@using ReserGO.Utils.UI
@using ReserGO.ViewModel.Interface.Header
@using ReserGO.ViewModel.Interface.Home;
@using Microsoft.AspNetCore.Components.Authorization
@using ReserGO.UI.Utils
@using ReserGO.UI.Login
@using ReserGO.ViewModel.Interface.Authentication
@using ReserGO.Miscellaneous.Enum
@using ReserGO.Utils.DTO.Utils
@using ReserGO.UI.FiltersComponent
@using ReserGO.UI.MainHome.Containers
@inject NavigationManager NaviMngr;
@inherits BaseComponentChild<IHomeViewModel, object>

<div class="d-flex flex-column loginContainter" style="@(CurrentViewModel.User.Roles != null && !CurrentViewModel.UserIs(RoleConst.GUEST) ? "background: linear-gradient(to bottom, #EEEEEE 50%, #FFFFFF 50%);": "")">


    <BaseComponent TViewModel="IHeaderViewModel" TModel="object">
        <Content>
            <Header Title="Studio Rossi" RightTitle="Accedi o Registrati" RightTitleEnabled="true" BackgroundColor="#0066FF" ColorFont="#FFFFFF"></Header>
        </Content>
    </BaseComponent>
    
    
    @if (CurrentViewModel.User.Roles != null && !CurrentViewModel.UserIs(RoleConst.GUEST))
    {
        @if (CurrentViewModel.ItemsMenu is object && CurrentViewModel.ItemsMenu.Count() > 0)
        {
        <MudPaper Height="100%">
            <MudDrawerContainer>
                    <MudDrawer @bind-Open="@_open" Fixed="false" Elevation="8" MiniWidth="100" Variant="@DrawerVariant.Mini" OpenMiniOnHover="true" Class="mainContent">
                    <MudNavMenu Class="mudDrawer">
                        @foreach (var item in CurrentViewModel.ItemsMenu)
                        {
                            <MudNavLink OnClick="() => ChangeComponent(item)">
                                    <div class="d-flex align-items-center textNavMenu">
                                        
                                        <MudIcon Icon="@item.Icon" Style="font-size: x-large; color:white;"  />
                                        
                                        @if (_open)
                                        {
                                            <span style="padding-inline:3px">@item.Text</span>
                                        }    
                                    </div>
                            </MudNavLink>
                        }
                    </MudNavMenu>
                </MudDrawer>
                <MudMainContent Class="row content mudblazor-main-content mainContent">
                    @CurrentViewModel.Content
                </MudMainContent>
            </MudDrawerContainer>
        </MudPaper>
        }
    }
    else
    {
        @if (CurrentViewModel.ItemsMenu is null || CurrentViewModel.ItemsMenu.Count() == 0 || (CurrentViewModel.ItemsMenu is object && CurrentViewModel.SelectedItem.Text.ToLower().Contains("home")))
        {
            <MainHomeContainer />
        }
        else
        {
            @CurrentViewModel.Content
        }
    }
</div>
 <BaseComponent TViewModel="ILoginViewModel" TModel="DTOLoginRequest">
        <Content>
            <CardLogin />
        </Content>
 </BaseComponent>
@code {
    private bool _open = true;

    private void ToggleDrawer()
    {
        _open = !_open;
    }
    protected override async Task OnInitializedAsync()
    {
        await CurrentViewModel.OnInitialize();
    }

    public void ChangeComponent(DTOSettingMenu menu)
    {
        CurrentViewModel.SelectedItem = menu;
        CurrentViewModel.ChangeComponent();
    }
}

<style>
    .loginContainter {
        width: 100%;
        height: 100%;
    }

    .textNavMenu {
        color: white;
        font-size: large;
        padding-left: 10px;
        font-family: ui-rounded, 'Hiragino Maru Gothic ProN', Quicksand, Comfortaa, Manjari, 'Arial Rounded MT', 'Arial Rounded MT Bold', Calibri, source-sans-pro, sans-serif;
    }

    .mud-nav-link.mud-ripple {
        padding-left: 0;
    }

    .mudDrawer {
        background-color: #0066FF;
    }

    .mud-drawer-content {
        background-color: #0066FF;
    }

    .mud-drawer.mud-drawer-pos-left.mud-drawer--open.mud-drawer--initial.mud-drawer-md.mud-drawer-clipped-never.mud-elevation-1.mud-drawer-mini {
        border-radius: 25px;
        height: 91%;
    }

    .mud-drawer-close-mini-md-left.mud-drawer-left-clipped-never {
        padding-left: 11vw;
    }

    .iconDrawer {
        color: white;
    }

    .mud-paper.mud-elevation-1 {
        padding-top: 5px;
    }

    .mud-main-content
    {
        padding:0 !important;
    }

    .mud-nav-link.mud-ripple {
        padding-left: 0;
        padding-block:20px !important;
    }
    .mainContent
    {
        height:100% !impostant;
    }

    .mud-drawer.mud-drawer-mini{
        height:92% !important;
        transition: width 225ms cubic-bezier(0, 0, 0.2, 1);
    }

        .mud-drawer.mud-drawer-mini.mud-drawer-pos-left.mud-drawer--open {
            width: var(--mud-drawer-width-left);
            border-radius: 15px 15px 0px 0px;
        }

    .mud-drawer-open-mini-md-left.mud-drawer-left-clipped-never{
        height:100% !important;
    }

    .mud-drawer-open-mini-md-left .mud-main-content {
        margin-left: var(--mud-drawer-width-left);
        height: 100%;
    }

    .mud-paper.mud-elevation-1 {
        background: linear-gradient(to bottom, #EEEEEE 50%, #FFFFFF 50%);
    }
</style>