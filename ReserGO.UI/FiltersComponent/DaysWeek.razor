@using MudBlazor
@using ReserGO.Miscellaneous.Model
@using ReserGO.Utils.UI
@using ReserGO.ViewModel.Interface.FiltersComponent
@using ReserGO.ViewModel.ViewModel.FiltersComponent

@inherits BaseComponentChild<IDayOfWeekViewModel, DTODayOfWeekWizard>

<div class="containerDayOfWeek h-100">
	<MudGrid>
		<MudItem xs="12">
			<div class="days-container">
				@foreach (var day in DaysOfWeek)
				{
					<MudButton Class="@($"day-circle {(day.IsSelected ? "selected" : "")}")" OnClick="@(() => ToggleDaySelection(day))" Title="@day.FullName">
						@day.Initial
					</MudButton>
				}
			</div>
		</MudItem>
	</MudGrid>
	<div class="d-flex h-50 p-3">
		<div style="max-height:3vh">
		@if (CurrentViewModel.List is object && CurrentViewModel.List.Count()>0)
		{
			<b>Giorni Selezionati:</b>
			@foreach(var day in CurrentViewModel.List)
			{
				<span>@($" {day.FullName},")</span>
			}
		}
		</div>
	</div>
	<div class="d-flex justify-content-center">
		<MudButton Color="Color.Primary" Variant="Variant.Filled" @onclick="GoNext" Disabled="CurrentViewModel.List.Count()==0">Avanti</MudButton>
	</div>
</div>


@code {
	[Parameter]
	public EventCallback<(List<DTODayOfWeekWizard> days, bool next)> Callback { get; set; }
	[Parameter]
	public List<DTODayOfWeekWizard> DaysSelected { get; set; }

	private List<DTODayOfWeekWizard> DaysOfWeek = new()
	{
		new DTODayOfWeekWizard { FullName = "Lunedì" },
		new DTODayOfWeekWizard { FullName = "Martedì" },
		new DTODayOfWeekWizard { FullName = "Mercoledì" },
		new DTODayOfWeekWizard { FullName = "Giovedì" },
		new DTODayOfWeekWizard { FullName = "Venerdì" },
		new DTODayOfWeekWizard { FullName = "Sabato" },
		new DTODayOfWeekWizard { FullName = "Domenica" }
	};

	// Metodo per gestire la selezione dei giorni

	protected override async Task OnParametersSetAsync()
	{
		if(DaysSelected!=null && DaysSelected.Count()>0)
		{
			var d = DaysSelected.Where(x => x.IsSelected).Select(x => x.FullName).ToList();
			DaysOfWeek.ForEach(day =>
			{
				if (d.Contains(day.FullName))
					day.IsSelected = true;
			});
		}
	}

	private async Task ToggleDaySelection(DTODayOfWeekWizard day)
	{
		day.IsSelected = !day.IsSelected;
		if (day.IsSelected)
			CurrentViewModel.List.Add(day);
		else
			CurrentViewModel.List = CurrentViewModel.List.Where(d => d.FullName != day.FullName).ToList();

		if (Callback.HasDelegate)
			await Callback.InvokeAsync((CurrentViewModel.List,false));
	}

	public async Task GoNext()
	{
		if (Callback.HasDelegate)
			await Callback.InvokeAsync((CurrentViewModel.List,true));
	}
}
<style>
	.days-container {
		display: flex;
		gap: 10px;
		justify-content: center;
		align-items: center;
		padding: 20px;
	}

	.day-circle {
		display: flex;
		justify-content: center;
		align-items: center;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		background-color: #e0e0e0;
		cursor: pointer;
		font-weight: bold;
		font-size: 16px;
		color: black;
		transition: background-color 0.3s ease;
		padding: 0;
		min-width: 40px;
	}

		.day-circle:hover {
			background-color: #bdbdbd;
		}

		.day-circle.selected {
			background-color: #1976d2;
			color: white;
		}
</style>